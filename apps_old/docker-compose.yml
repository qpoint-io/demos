# This file is generated by ./tools/generate.sh
version: '3.8'

services:
  curl-geoweather:
    build:
      context: curl-geoweather/
      args:
        - TOKEN=${TOKEN}
    environment:
      - HTTP_PROXY=${QPOINT_HTTP_PROXY}
      - HTTPS_PROXY=${QPOINT_HTTPS_PROXY}
    ports:
      - "4000:80"
    depends_on:
      - qpoint.local
  go-geoweather:
    build:
      context: go-geoweather/
      args:
        - TOKEN=${TOKEN}
    environment:
      - HTTP_PROXY=${QPOINT_HTTP_PROXY}
      - HTTPS_PROXY=${QPOINT_HTTPS_PROXY}
    ports:
      - "4001:80"
    depends_on:
      - qpoint.local
  php-geoweather:
    build:
      context: php-geoweather/
      args:
        - TOKEN=${TOKEN}
    environment:
      - HTTP_PROXY=${QPOINT_HTTP_PROXY}
      - HTTPS_PROXY=${QPOINT_HTTPS_PROXY}
    ports:
      - "4002:80"
    depends_on:
      - qpoint.local
  python-geoweather:
    build:
      context: python-geoweather/
      args:
        - TOKEN=${TOKEN}
    environment:
      - HTTP_PROXY=${QPOINT_HTTP_PROXY}
      - HTTPS_PROXY=${QPOINT_HTTPS_PROXY}
    ports:
      - "4003:80"
    depends_on:
      - qpoint.local
  qpoint.local:
    image: "us-docker.pkg.dev/qpoint-edge/public/qpoint:head"
    environment:
      - TOKEN=${TOKEN}
    command: >
      proxy
      --envoy-log-level=info
      --log-level=debug
      --registration-token=$TOKEN
      --log-encoding="console"
      --dns-lookup-family="V4_ONLY"
    ports:
      - "10080:10080"
      - "10443:10443"
      - "18080:18080"
      - "18443:18443"
      - "9901:9901"
